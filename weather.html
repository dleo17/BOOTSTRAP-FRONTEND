<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Aktuelles Live Wetter â€“ Info Website 2025</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Global Styles -->
  <link href="styles.css" rel="stylesheet">

  <style>
    /* ===== Global layout fallback ===== */
    body {
      min-height: 100vh;
      margin: 0;
      color: #eaf2ff;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    /* ===== Animated Weather Background (dark, stormy, moving glows) ===== */
    body.weather-theme {
      background:
        radial-gradient(1200px 700px at 10% 0%, rgba(0, 176, 255, .16), transparent 60%),
        radial-gradient(900px 600px at 90% 100%, rgba(0, 255, 200, .12), transparent 60%),
        #050814;
      overflow-x: hidden;
      position: relative;
    }

    body.weather-theme::before,
    body.weather-theme::after {
      content: "";
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 0;
      background:
        radial-gradient(500px 400px at 20% 25%, rgba(0, 255, 200, .14), transparent 60%),
        radial-gradient(650px 500px at 80% 70%, rgba(78, 148, 255, .16), transparent 65%);
      filter: blur(8px);
      animation: weatherDrift 20s ease-in-out infinite alternate;
      mix-blend-mode: screen;
    }

    body.weather-theme::after {
      background:
        radial-gradient(360px 260px at 70% 20%, rgba(147, 197, 253, .25), transparent 60%),
        radial-gradient(380px 280px at 25% 80%, rgba(45, 212, 191, .18), transparent 65%);
      animation-duration: 26s;
    }

    @keyframes weatherDrift {
      from {
        transform: translate3d(-1.5%, -1.5%, 0);
      }
      to {
        transform: translate3d(1.5%, 1.5%, 0);
      }
    }

    /* keep content above background */
    #site-nav,
    main {
      position: relative;
      z-index: 1;
    }

    /* ===== Typography ===== */
    h1 {
      color: #dbeafe;
      text-shadow: 0 4px 18px rgba(0, 0, 0, .7);
    }

    p.text-muted {
      color: #cbd5f5 !important;
    }

    /* ===== Cards & panels ===== */
    .weather-card,
    .chart-card,
    .forecast-card {
      border-radius: 1rem;
      border: 1px solid rgba(148, 205, 255, 0.28);
      background: radial-gradient(circle at top left, rgba(15, 23, 42, .95), rgba(6, 11, 25, .98));
      box-shadow:
        0 1.4rem 2.8rem rgba(0, 0, 0, .75),
        0 0 26px rgba(56, 189, 248, .25);
      backdrop-filter: blur(16px);
    }

    #weatherResult {
      background: rgba(15, 23, 42, 0.9);
      border-radius: .8rem;
      min-height: 120px;
      border: 1px solid rgba(148, 205, 255, .35);
      box-shadow: inset 0 0 14px rgba(15, 23, 42, 0.9);
      padding: 1rem 1.25rem;
      font-size: 1rem;
      line-height: 1.5;
      color: #e5edff;
    }

    /* Chart container */
    #weatherChart {
      width: 100%;
      height: 320px;
      border-radius: .8rem;
      background: rgba(15, 23, 42, 0.95);
      border: 1px solid rgba(148, 205, 255, .3);
      box-shadow:
        inset 0 0 14px rgba(15, 23, 42, 0.9),
        0 1rem 2rem rgba(15, 23, 42, .9);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #9ca3c7;
      text-align: center;
      padding: 1rem;
    }

    .chart-header-row {
      display: flex;
      flex-direction: column;
      gap: .75rem;
    }

    @media (min-width: 768px) {
      .chart-header-row {
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
      }
    }

    .chart-meta {
      font-size: .8rem;
      color: #9ca3c7;
    }

    #chartStatus {
      font-size: .8rem;
      font-weight: 500;
      color: #9ca3c7;
    }

    #chartStatus.ready {
      color: #86efac;
      text-shadow: 0 0 10px rgba(22, 163, 74, .7);
    }

    .source-line {
      font-size: .75rem;
      color: #9ca3c7;
      text-align: center;
    }

    /* ===== Buttons ===== */
    .pill-btn-main {
      border-radius: 999px;
      padding: 0.8rem 1.8rem;
      font-weight: 600;
      font-size: 1rem;
      background: linear-gradient(135deg, #0ea5e9, #22c55e);
      border: none;
      box-shadow:
        0 1rem 2.2rem rgba(14, 165, 233, 0.6),
        0 0 26px rgba(45, 212, 191, .65);
      transition: transform 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease;
      color: #f9fafb;
    }

    .pill-btn-main:hover {
      filter: brightness(1.08);
      transform: translateY(-1px) scale(1.03);
      box-shadow:
        0 1.4rem 2.8rem rgba(14, 165, 233, 0.7),
        0 0 34px rgba(45, 212, 191, .75);
      color: #f9fafb;
    }

    .pill-btn-main:active {
      transform: translateY(0) scale(.98);
      box-shadow: 0 .6rem 1.4rem rgba(0, 0, 0, .8);
    }

    .pill-btn-small {
      border-radius: 9999px;
      font-size: .8rem;
      font-weight: 600;
      background: linear-gradient(135deg, #0ea5e9, #6366f1);
      color: #f9fafb;
      border: none;
      padding: .55rem 1rem;
      box-shadow: 0 .8rem 1.6rem rgba(79, 70, 229, 0.65);
      transition: transform 0.18s ease, box-shadow 0.18s ease, filter 0.18s ease;
    }

    .pill-btn-small:hover {
      filter: brightness(1.08);
      transform: translateY(-1px) scale(1.03);
      box-shadow: 0 1rem 2rem rgba(79, 70, 229, 0.75);
      color: #f9fafb;
    }

    .pill-btn-small:active {
      transform: translateY(0) scale(.97);
      box-shadow: 0 .5rem 1.2rem rgba(0, 0, 0, .85);
    }

    /* ===== Forecast header text on dark bg ===== */
    .forecast-title,
    .forecast-sub,
    .chart-status,
    .chart-status.ready,
    .source-line {
      color: #e5edff !important;
      text-shadow: 0 0 10px rgba(0, 0, 0, 0.7);
    }

    /* ===== Highcharts text readable on dark background ===== */
    .highcharts-axis-labels text,
    .highcharts-legend-item text,
    .highcharts-title text,
    .highcharts-subtitle text {
      fill: #e5edff !important;
    }
  </style>
</head>

<body data-page="weather" class="weather-theme">
  <div id="site-nav"></div>

  <main class="container py-5">
    <h1 class="display-6 fw-bold mb-3 text-center">ðŸŒ¦ Aktuelles Live Wetter</h1>
    <p class="text-center text-muted mb-4">
      Standort: ZÃ¼rich (47.3769 / 8.5417). Echte Wetterdaten aus der Open-Meteo API.
    </p>

    <!-- Abschnitt 1: Heutige Werte -->
    <div class="text-center mb-4">
      <button id="btnWeather" class="btn pill-btn-main">
        Heutiges Wetter laden
      </button>
    </div>

    <div class="weather-card shadow-lg mb-5">
      <div class="card-body">
        <div id="weatherResult" class="text-muted d-flex align-items-center justify-content-center">
          <span>Wetterdaten folgenâ€¦</span>
        </div>
      </div>
    </div>

    <!-- Abschnitt 2: Diagramm -->
    <!-- Abschnitt 2: Diagramm -->
<div class="forecast-card shadow-lg">
  <div class="forecast-header d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center">
    <div class="mb-3 mb-md-0">
      <div class="forecast-title">Vorhersage (nÃ¤chste 5 Tage)</div>
      <div class="forecast-sub">
        Temperatur (Â°C, Linie) Â· Niederschlag (mm, SÃ¤ulen)
      </div>
    </div>

    <div class="text-md-end">
      <button id="btnChart" class="btn pill-btn-small w-100 w-md-auto">
        Diagramm laden
      </button>
      <div id="chartStatus" class="chart-status mt-2">
        Noch kein Diagramm geladenâ€¦
      </div>
    </div>
  </div>

  <div id="weatherChart" class="chart-area">
    <span>Chart folgtâ€¦</span>
  </div>

  <div class="source-line text-center">
    Datenquelle: Open-Meteo (hourly forecast, 5 Tage)
  </div>
</div>

  </main>

  <!-- jQuery / Bootstrap -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Highcharts -->
  <script src="https://code.highcharts.com/highcharts.js"></script>

  <!-- Gemeinsames App-Skript (fÃ¼r Navbar laden etc.) -->
  <script src="app.js"></script>

  <script>
    // Fixe Koordinaten ZÃ¼rich
    const LAT = 47.3769;
    const LON = 8.5417;

    // =========================
    // Teil 1: Tageswerte (heute)
    // =========================
    $('#btnWeather').on('click', function () {
      const $out = $('#weatherResult');
      $out
        .removeClass('text-danger')
        .removeClass('text-muted')
        .html('<span class="text-muted">Lade Wetterdatenâ€¦</span>');

      const urlToday =
        `https://api.open-meteo.com/v1/forecast?latitude=${LAT}&longitude=${LON}` +
        `&daily=temperature_2m_max,temperature_2m_min,precipitation_sum&forecast_days=1&timezone=Europe%2FZurich`;

      $.getJSON(urlToday)
        .done(function(data) {
          const daily = data.daily;
          if (!daily) {
            $out
              .addClass('text-danger')
              .html('<div>Keine Wetterdaten gefunden.</div>');
            return;
          }

          const tmax = daily.temperature_2m_max?.[0];
          const tmin = daily.temperature_2m_min?.[0];
          const rain = daily.precipitation_sum?.[0];

          $out.html(`
            <div class="text-center text-md-start">
              <div class="mb-2">
                <span class="fw-semibold">Ort:</span>
                <span>ZÃ¼rich, CH</span>
              </div>
              <div class="mb-1">
                <span class="fw-semibold">Maximal:</span>
                <span>${tmax}Â°C</span>
              </div>
              <div class="mb-1">
                <span class="fw-semibold">Minimal:</span>
                <span>${tmin}Â°C</span>
              </div>
              <div class="mb-0">
                <span class="fw-semibold">Niederschlag heute:</span>
                <span>${rain} mm</span>
              </div>
            </div>
          `);
        })
        .fail(function() {
          $out
            .addClass('text-danger')
            .html('<div>Fehler beim Abrufen der Wetterdaten.</div>');
        });
    });

    // =====================================
    // Teil 2: Highcharts 5-Tage-Vorhersage
    // =====================================

    $('#btnChart').on('click', function () {
      const $status = $('#chartStatus');
      $status
        .removeClass('ready')
        .text('Lade Vorhersageâ€¦');

      const url5days =
        `https://api.open-meteo.com/v1/forecast?latitude=${LAT}&longitude=${LON}` +
        `&hourly=temperature_2m,precipitation&forecast_days=5&timezone=Europe%2FZurich`;

      $.getJSON(url5days)
        .done(function(data) {
          const hourly = data.hourly;
          if (!hourly || !hourly.time || !hourly.temperature_2m || !hourly.precipitation) {
            $status.text('Konnte Vorhersage nicht laden ðŸ˜•');
            return;
          }

          // Highcharts-Serien vorbereiten
          const temperatureSeries = [];
          const rainSeries = [];

          for (let i = 0; i < hourly.time.length; i++) {
            const ts = new Date(hourly.time[i]).getTime(); // ISO -> ms
            const tempVal = hourly.temperature_2m[i];
            const rainVal = hourly.precipitation[i];

            temperatureSeries.push([ts, tempVal]);
            rainSeries.push([ts, rainVal]);
          }

          Highcharts.chart('weatherChart', {
            chart: {
              zoomType: 'x',
              backgroundColor: 'transparent'
            },
            title: {
              text: 'Temperatur & Niederschlag (nÃ¤chste 5 Tage)',
              style: {
                color: '#0d47a1',
                textShadow: '0 1px 4px rgba(13,110,253,.3)',
                fontWeight: '600'
              }
            },
            xAxis: {
              type: 'datetime',
              labels: { format: '{value:%d.%m %H:%M}' },
              crosshair: true,
              lineColor: 'rgba(13,110,253,.4)',
              tickColor: 'rgba(13,110,253,.4)'
            },
            yAxis: [{
              title: { text: 'Temperatur (Â°C)' },
              labels: { style: { color: '#0d6efd', fontWeight: '500' } },
              lineColor: 'rgba(13,110,253,.4)',
              gridLineColor: 'rgba(13,110,253,.07)'
            }, {
              title: { text: 'Niederschlag (mm)' },
              labels: { style: { color: '#495057', fontWeight: '500' } },
              opposite: true,
              lineColor: 'rgba(108,117,125,.4)',
              gridLineColor: 'rgba(13,110,253,.07)'
            }],
            tooltip: {
              shared: true,
              backgroundColor: 'rgba(255,255,255,0.95)',
              borderColor: 'rgba(13,110,253,.4)',
              borderRadius: 8,
              style: { color: '#1b2a4e' },
              xDateFormat: '%d.%m.%Y %H:%M',
              headerFormat: '<span style="font-weight:600">{point.key}</span><br/>'
            },
            legend: {
              layout: 'horizontal'
            },
            series: [
              {
                name: 'Temperatur (Â°C)',
                type: 'spline',
                data: temperatureSeries,
                yAxis: 0
              },
              {
                name: 'Niederschlag (mm)',
                type: 'column',
                data: rainSeries,
                yAxis: 1
              }
            ]
          });

          $status
            .addClass('ready')
            .text('Diagramm geladen âœ”');
        })
        .fail(function() {
          $status
            .removeClass('ready')
            .text('Fehler beim Laden der Vorhersage ðŸ˜¬');
        });
    });
  </script>
</body>
</html>